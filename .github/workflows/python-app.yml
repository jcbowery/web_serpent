name: CI

on:
 push:
   branches: [ "main" ]
 pull_request:
   branches: [ "main" ]

jobs:

 lint:
   runs-on: ubuntu-latest
   steps:
   - uses: actions/checkout@v3
   - name: Set up Python
     uses: actions/setup-python@v4
     with:
       python-version: "3.12"
   - name: Install dependencies
     run: |
       python -m pip install --upgrade pip
       pip install pylint
   - name: Lint with pylint
     run: |
       pylint **/*.py

 test:
   runs-on: ubuntu-latest
   steps:
   - uses: actions/checkout@v3
   - name: Set up Python
     uses: actions/setup-python@v4
     with:
       python-version: "3.12"
   - name: Install dependencies
     run: |
       python -m pip install --upgrade pip
       pip install pytest
   - name: Test with pytest
     run: |
       pytest

 build:
   runs-on: ubuntu-latest
   needs: [lint, test]
   steps:
   - uses: actions/checkout@v3
   - name: Set up Python
     uses: actions/setup-python@v4
     with:
       python-version: "3.12"
   - name: Build a distribution
     run: |
       python setup.py sdist bdist_wheel
   - name: Publish to GitHub Packages
     uses: actions/upload-artifact@v3
     with:
       name: package
       path: dist
